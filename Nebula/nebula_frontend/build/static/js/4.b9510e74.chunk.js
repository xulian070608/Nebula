(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[4],{733:function(e,t,a){"use strict";a.r(t);var n=a(8),r=a(730),i=a(0),o=a.n(i),c=a(688),s=a(720);var l=function(){var e=new r.Group,t=new r.DirectionalLight(16777215,.65);t.position.set(6e4,6e4,6e4),e.add(t);var a=new r.DirectionalLight(16777215,1);return a.position.set(-6e4,-6e4,6e4),e.add(a),e},m=a(731),u=a.n(m);var p=function(e,t){var a=t.gravityX,n=t.gravityY,i=e.userData.roomNumber,o=new u.a({text:i,fontSize:64,fontFamily:"Arial, Helvetica, sans-serif",align:"center",fontWeight:"bold",fontStyle:"normal"}),c=new r.SpriteMaterial({color:"rgb(0,0,0)",map:o}),s=new r.Sprite(c),l=900,m=i.split("\n").length;m>1&&(l=m*(l-.26));var p=o.image.width,g=o.image.height;return s.scale.set(1,1,1),s.scale.setX(p/g).multiplyScalar(l),s.position.set(a,n,600),s};var g=function(e,t){e.geometry.computeBoundingBox();var a,n=t.gravityX,i=t.gravityY;switch(e.userData.roomName){case"MEN WC":a="https://api.c3plus.top/media/images/origin/wc_m2x.png";break;case"W RESTROOM":case"WOMEN WC":a="https://api.c3plus.top/media/images/origin/wc_f2x.png";break;case"RESTROOM":case"UNISEX":a="https://api.c3plus.top/media/images/origin/wc_u2x.png";break;case"VIP Lounge":case"MINI LOUNGE":case"LOUNGE":a="https://api.c3plus.top/media/images/origin/lounge.png";break;case"IT":a="https://api.c3plus.top/media/images/origin/IT_room2x.png";break;case"MAIL":a="https://api.c3plus.top/media/images/origin/mail_room2x.png";break;case"PHONE BOOTH":a="https://api.c3plus.top/media/images/origin/phone_booth2x.png";break;case"Cafe":case"PANTRY":a="https://api.c3plus.top/media/images/origin/pantry2x.png";break;case"PRINTER":a="https://api.c3plus.top/media/images/origin/printer2x.png";break;case"STOR":a="https://api.c3plus.top/media/images/origin/storage2x.png";break;case"STAIR FOYER":a="https://api.c3plus.top/media/images/origin/stair.png";break;case"MOTHER RM":a="https://api.c3plus.top/media/images/origin/motherroom2x.png";break;case"MOP":a="https://api.c3plus.top/media/images/origin/maintenance2x.png";break;case"MECH":a="https://api.c3plus.top/media/images/origin/mechanical2x.png";break;case"ADA":a="https://api.c3plus.top/media/images/origin/wc_ada.png";break;case"COMMUNITY BAR":a="https://api.c3plus.top/media/images/origin/we_reception.png";break;default:return new r.Object3D}var o=(new r.TextureLoader).load(a),c=new r.SpriteMaterial({map:o}),s=new r.Sprite(c);return s.scale.multiplyScalar(1e3),s.position.set(n,i,600),s},h=a(31);function d(e){for(var t=0,a=0,n=0,r=0;r<e.length;r++){var i=e[r][0],o=e[r][1],c=e[(r+1)%e.length][0],s=e[(r+1)%e.length][1],l=(c*o-s*i)/2;t+=l,a+=l*(i+c)/3,n+=l*(o+s)/3}return{gravityX:a/=t,gravityY:n/=t}}var b=function(e){var t,a=e.id,i=e.attributes,o=i.room_name,c=i.room_number,s=i.area,l=i.has_window,m=i.deskcount,u=i.physical_deskcount,b=i.program_type,f=i.internal_room_count,v=i.has_av,E=i.outline;if("WORK"===b||"MEET"===b){var w;switch(l){case!0:w=15004663;break;default:w=h.b[b]}var x=function(e){for(var t=e.coordinates,a=t[0],n=[],i=0;i<a.length;i++){var o=a[i][0],c=a[i][1],s=new r.Vector2(o,c);n.push(s)}var l=new d(a),m=new r.Shape(n);if(t.length>1){for(var u=t.slice(1,t.length),p=[],g=0;g<u.length;g++){for(var h=[],b=0;b<u[g].length;b++){var f=u[g][b][0],v=u[g][b][1],E=new r.Vector2(f,v);h.push(E)}p.push(new r.Path(h))}m.holes=p}return[new r.ExtrudeBufferGeometry(m,{steps:1,depth:1500,bevelEnabled:!1}),l]}(E),y=Object(n.a)(x,2),k=y[0],O=y[1],j=new r.MeshPhongMaterial({color:w,side:r.BackSide,transparent:!1,shininess:0});(t=new r.Mesh(k,j)).userData={roomID:a,roomName:o,roomNumber:c,area:s,deskcount:m,physicalDeskcount:u,internalRoomCount:f,hasAV:v,programType:b,hasWindow:l};var H=new p(t,O);t.add(H);var N=new r.EdgesGeometry(k,1),S=new r.LineBasicMaterial({color:0,linewidth:1}),D=new r.LineSegments(N,S);return t.add(D),t.position.z=1,t.callback=function(){alert("hello three")},t}var C=function(e){for(var t=e.coordinates,a=t[0],n=[],i=0;i<a.length;i++){var o=a[i][0],c=a[i][1],s=new r.Vector2(o,c);n.push(s)}var l=new d(a),m=new r.Shape(n);if(t.length>1){for(var u=t.slice(1,t.length),p=[],g=0;g<u.length;g++){for(var h=[],b=0;b<u[g].length;b++){var f=u[g][b][0],v=u[g][b][1],E=new r.Vector2(f,v);h.push(E)}p.push(new r.Path(h))}m.holes=p}return[new r.ShapeBufferGeometry(m),l]}(E),_=Object(n.a)(C,2),R=_[0],P=_[1],T=new r.LineBasicMaterial({color:h.b[b]});(t=new r.Mesh(R,T)).userData={roomName:o,roomNumber:c,hasAV:v,programType:b},t.receiveShadow=!0;var I=new g(t,P);return t.add(I),t};function f(e){var t,a,n=e.bb3,r=e.targetWidth,i=e.targetHeight,o=n.min.x,c=n.max.x,s=n.max.y,l=n.min.y;return r/i>(c-o)/(s-l)?t=(a=s-l+18e3)*(r/i):a=(t=c-o+18e3)*(i/r),{width:t,height:a}}var v=function(e){var t=f(e),a=t.width,n=t.height,i=new r.OrthographicCamera(-a/2,a/2,n/2,-n/2,-3e5,3e5);return i.up.set(0,0,1),i.position.set(0,0,3e4),i.zoom=1,i.updateProjectionMatrix(),i},E=a(732);var w=function(e){var t=e.camera,a=e.renderer,n=new E.a(t,a.domElement);return n.enableRotate=!0,n.maxPolarAngle=Math.PI/2,n.mouseButtons={LEFT:r.MOUSE.PAN,MIDDLE:r.MOUSE.DOLLY,RIGHT:r.MOUSE.ROTATE},n.screenSpacePanning=!0,n.target.set(0,0,0),n},x=a(53),y=a(684),k=a(716),O=a(654),j=a(689),H=Object(y.a)((function(e){return{card:{minWidth:250},info:{fontSize:16,paddingLeft:e.spacing(2),color:4342338}}}));var N=function(e){var t=H(),a=e.isTouched,r=e.roomInfo,c=r.roomName,s=r.roomNumber,l=r.deskcount,m=r.physicalDeskcount,u=Object(i.useState)(window.innerWidth/3),p=Object(n.a)(u,2),g=p[0],h=p[1],d=Object(i.useState)(window.innerHeight/10),b=Object(n.a)(d,2),f=b[0],v=b[1],E={clientWidth:0,clientHeight:80,getBoundingClientRect:function(){return{width:0,height:0,top:f,bottom:f,right:g,left:g}}};return window.addEventListener("resize",(function(){h(window.innerWidth/3),v(window.innerHeight/10)}),!1),o.a.createElement(k.a,{open:a,anchorEl:E,transition:!0,placement:"bottom-start"},(function(e){var a=e.TransitionProps;return o.a.createElement(O.a,Object.assign({},a,{timeout:350}),o.a.createElement(j.a,{className:t.card},o.a.createElement(x.a,{l:"5",className:t.info},"Room Name: ",c),o.a.createElement(x.a,{l:"5",className:t.info},"Room Number: ",s),o.a.createElement(x.a,{l:"5",className:t.info},"Desk Count: ",l),o.a.createElement(x.a,{l:"5",className:t.info},"Physical Desk Count: ",m)))}))},S=a(89),D=a.n(S),C=a(32),_=a(699),R=a(259),P=a.n(R),T=a(691),I=a(686),L=a(698),M=a(697),W=a(722),A=Object(y.a)((function(e){return{paper:{width:600,backgroundColor:e.palette.background.paper}}})),B=o.a.forwardRef((function(e,t){var a=A(),r=e.currentProjectID,s=e.floorID,l=e.roomID,m=h.a+r+"/floors/"+s+"/rooms/"+l+"/",u=Object(C.a)(m),p=u.data,g=u.loaded,d=Object(i.useState)(String),b=Object(n.a)(d,2),f=b[0],v=b[1],E=Object(i.useState)(String),w=Object(n.a)(E,2),x=w[0],y=w[1],k=Object(i.useState)(Number),O=Object(n.a)(k,2),j=O[0],H=O[1],N=Object(i.useState)(Number),S=Object(n.a)(N,2),R=S[0],B=S[1],V=Object(i.useState)(String),z=Object(n.a)(V,2),G=z[0],Y=z[1],F=Object(i.useState)(Number),U=Object(n.a)(F,2),X=U[0],K=U[1],q=Object(i.useState)(Boolean),J=Object(n.a)(q,2),Q=J[0],Z=J[1],$=Object(i.useState)(Boolean),ee=Object(n.a)($,2),te=ee[0],ae=ee[1],ne=Object(i.useState)(String),re=Object(n.a)(ne,2),ie=re[0],oe=re[1];Object(i.useEffect)((function(){g&&(v(p.attributes.room_name),y(p.attributes.room_number),H(p.attributes.deskcount),B(p.attributes.physical_deskcount),Y(p.attributes.program_type),K(p.attributes.internal_room_count),Z(p.attributes.has_window),ae(p.attributes.has_av),oe(p.attributes.note))}),[g,p]);var ce=Object(i.useState)(!1),se=Object(n.a)(ce,2),le=se[0],me=se[1],ue={headers:{"Content-Type":"application/vnd.api+json"}};return g?o.a.createElement("div",{className:a.paper,ref:t,tabIndex:-1},le?o.a.createElement(L.a,{maxWidth:"md"},o.a.createElement(I.a,{container:!0,alignItems:"center",justify:"center",spacing:1,style:{minHeight:"10vh"}},o.a.createElement(I.a,{item:!0,xs:8,align:"center"},f+" "+x),o.a.createElement(I.a,{item:!0,xs:4,align:"center"},o.a.createElement(c.a,{variant:"outlined",size:"small",onClick:function(){me(!1);var e={data:{type:"Room",id:l,attributes:{room_name:f,room_number:x,deskcount:j,physical_deskcount:R,program_type:G,internal_room_count:X,has_window:Q,has_av:te,note:ie}}};D.a.patch(m,e,ue)}},"Save"))),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Room Name:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},o.a.createElement(_.a,{defaultValue:f,inputProps:{"aria-label":"description"},onChange:function(e){return v(e.target.value)}}))),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Room Number:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},o.a.createElement(_.a,{defaultValue:x,inputProps:{"aria-label":"description"},onChange:function(e){return y(e.target.value)}}))),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Desk Count:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},o.a.createElement(_.a,{defaultValue:j,inputProps:{"aria-label":"description"},onChange:function(e){return H(e.target.value)}}))),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Physical Desk Count:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},o.a.createElement(_.a,{defaultValue:R,inputProps:{"aria-label":"description"},onChange:function(e){return B(e.target.value)}}))),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Program Type:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},o.a.createElement(_.a,{disabled:!0,defaultValue:G,inputProps:{"aria-label":"description"},onChange:function(e){return Y(e.target.value)}}))),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Internal Room Count:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},o.a.createElement(_.a,{defaultValue:X,inputProps:{"aria-label":"description"},onChange:function(e){return K(e.target.value)}}))),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Has Window:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},o.a.createElement(W.a,{checked:Q,onChange:function(e){Z(e.target.checked)},inputProps:{"aria-label":"primary checkbox"}}))),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Has AV:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},o.a.createElement(W.a,{checked:te,onChange:function(e){ae(e.target.checked)},inputProps:{"aria-label":"primary checkbox"}}))),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Note:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},o.a.createElement(_.a,{defaultValue:ie,inputProps:{"aria-label":"description"},onChange:function(e){return oe(e.target.value)}})))):o.a.createElement(L.a,{maxWidth:"md"},o.a.createElement(I.a,{container:!0,spacing:1,alignItems:"center",justify:"center",style:{minHeight:"10vh"}},o.a.createElement(I.a,{item:!0,xs:8,align:"center"},f+" "+x),o.a.createElement(I.a,{item:!0,xs:4,align:"center"},o.a.createElement(T.a,{"aria-label":"edit",size:"medium",onClick:function(){return me(!0)}},o.a.createElement(P.a,{fontSize:"inherit"})))),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Room Name:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},f)),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Room Number:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},x)),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Desk Count:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},j)),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Physical Desk Count:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},R)),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Program Type:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},G)),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Internal Room Count:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},X)),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Has Window:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},o.a.createElement(W.a,{disabled:!0,checked:Q,inputProps:{"aria-label":"disabled checked checkbox"}}))),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Has AV:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},o.a.createElement(W.a,{disabled:!0,checked:te,inputProps:{"aria-label":"disabled checked checkbox"}}))),o.a.createElement(I.a,{container:!0,spacing:1,style:{minHeight:"7vh"}},o.a.createElement(I.a,{item:!0,xs:6},"Note:"),o.a.createElement(I.a,{item:!0,xs:6,align:"right"},ie)))):o.a.createElement("div",{style:{width:450},ref:t,tabIndex:-1},o.a.createElement(M.a,{style:{position:"absolute",top:"50%",left:"50%"}}))}));var V=function(e){var t=e.mode,a=e.envLights,n=e.camera,i=e.showAxes,o=new r.Group;if("on"===t){if(a&&a.children.forEach((function(e){var t=new r.DirectionalLightHelper(e);o.add(t)})),n){var c=new r.CameraHelper(n);o.add(c)}if(i){var s=new r.AxesHelper(5);o.add(s)}}return o},z=Object(y.a)((function(e){return{root:{width:"100%",height:"100%"},viz:{width:"100%",height:"100%"},button:{position:"absolute",top:100,right:20,background:"rgb(225,225,225)"},popper:{position:"absolute",marginLeft:100,marginTop:e.spacing(0)},modal:{display:"flex",justifyContent:"center",alignItems:"center"}}}));t.default=function(e){var t,a,i=o.a.useRef,m=o.a.useEffect,u=o.a.useState,p=i(null),g=e.floorID,d=e.currentProjectID,E=h.a+d+"/floors/"+g+"/rooms/",x=!1,y=!1,k=new r.Vector2,O=new r.Raycaster,j=u(Boolean),H=Object(n.a)(j,2),S=H[0],D=H[1],_=u({roomName:String,roomNumber:String,deskCount:Number,physicalDeskCount:Number}),R=Object(n.a)(_,2),P=R[0],T=R[1],I=u(!1),L=Object(n.a)(I,2),M=L[0],W=L[1],A=u(null),G=Object(n.a)(A,2),Y=G[0],F=G[1],U=Object(C.b)(E),X=U.data;m((function(){var e=p.current.clientWidth,n=p.current.clientHeight,i=new r.Scene;i.background=new r.Color(15790320);var o=new r.WebGLRenderer({antialias:!0});o.setClearColor("rgb(120, 120, 120)"),o.setSize(e,n);var c=new r.Group;c.name="primary";var s=new r.Group;s.name="secondary_work";var m=new r.Group;m.name="secondary_extra";var u=[];X.forEach((function(e){return u.push(new b({id:e.id,attributes:e.attributes}))})),u.forEach((function(e){e.userData.programType&&("WORK"===e.userData.programType||"MEET"===e.userData.programType)?s.add(e):m.add(e)})),c.add(s),c.add(m);var g=new r.Box3;g.setFromObject(c).getCenter(c.position).multiplyScalar(-1),i.add(c);var h=new l;i.add(h);var d=new v({bb3:g,targetWidth:e,targetHeight:n});i.add(d);var E=new w({camera:d,renderer:o}),j=new V({mode:"off",showAxes:!0});i.add(j);var H=function(){o.render(i,d)},N=function(){e=p.current.clientWidth,n=p.current.clientHeight,o.setSize(e,n);var t=f({bb3:g,targetWidth:e,targetHeight:n}),a=t.width,r=t.height;d.left=-a/2,d.right=a/2,d.top=r/2,d.bottom=-r/2,d.updateProjectionMatrix(),H()},S=function(e){e.preventDefault(),x=!x;var t=i.getObjectByName("secondary_work");if(t)var a=t.children;x?a.forEach((function(e){"WORK"===e.userData.programType&&(e.userData.deskcount>10?e.material.color.setHex(16516080):e.material.color.setHex(6579300))})):a.forEach((function(e){"WORK"===e.userData.programType&&(e.userData.hasWindow?e.material.color.setHex(15004663):e.material.color.setHex(11263463))}))},C=function(){y=!1,t=setTimeout((function(){y=!0}),200)},_=function(t,a){k.x=t/e*2-1,k.y=-a/n*2+1},R=function(e){e.preventDefault(),_(e.offsetX,e.offsetY),O.setFromCamera(k,d);var t=i.getObjectByName("secondary_work");if(t)var n=O.intersectObjects(t.children);n.length>0?n[0].object!==a&&(a&&a.material.color.setHex(a.currentHex),a=n[0].object,T({roomName:a.userData.roomName,roomNumber:a.userData.roomNumber,deskcount:a.userData.deskcount,physicalDeskcount:a.userData.physicalDeskcount}),D(!0),a.currentHex=a.material.color.getHex(),a.material.color.setHex(16777215)):(a&&a.material.color.setHex(a.currentHex),a=null,D(!1))},P=function(e){e.preventDefault(),_(e.offsetX,e.offsetY),O.setFromCamera(k,d);var a=i.getObjectByName("secondary_work");if(a)var n=O.intersectObjects(a.children);y?y=!1:(clearTimeout(t),n.length>0&&(F(n[0].object.userData.roomID),W(!0)))};p.current.appendChild(o.domElement),window.addEventListener("resize",N),p.current.addEventListener("mousemove",R,!1),p.current.addEventListener("mousedown",C,!1),p.current.addEventListener("mouseup",P,!1);var I=document.getElementById("button");return I.addEventListener("click",S,!1),requestAnimationFrame((function e(){H(),window.requestAnimationFrame(e),E.update()})),function(){window.removeEventListener("resize",N),p.current.removeEventListener("mousemove",R),p.current.removeEventListener("mousedown",C),p.current.removeEventListener("mouseup",P),p.current.removeChild(o.domElement),I.removeEventListener("click",S),u.forEach((function(e){i.remove(e),e.geometry.dispose(),e.material.dispose()}))}}),[U.loaded,X]);var K=z();return o.a.createElement("div",{className:K.root},o.a.createElement("div",{className:K.viz,ref:p}),o.a.createElement(c.a,{id:"button",className:K.button,variant:"outlined"},"Above 10 desks"),S?o.a.createElement(N,{isTouched:S,roomInfo:P}):null,Y?o.a.createElement(s.a,{className:K.modal,anchor:"left",open:M,onClose:function(){W(!1),F(null)}},o.a.createElement(B,{currentProjectID:d,floorID:g,roomID:Y})):null)}}}]);
//# sourceMappingURL=4.b9510e74.chunk.js.map